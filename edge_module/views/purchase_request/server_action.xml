<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Create a server action to open the import wizard -->
    <record id="action_purchase_request_import_excel" model="ir.actions.server">
        <field name="name">Import from Excel</field>
        <field name="model_id" ref="model_purchase_request"/>
        <field name="binding_model_id" ref="model_purchase_request"/>
        <field name="state">code</field>
        <field name="code">
if records:
    if records.filtered(lambda r: r.state == 'draft'):
        action = {
            'name': 'Import Purchase Request',
            'type': 'ir.actions.act_window',
            'res_model': 'purchase.request.import.wizard',
            'view_mode': 'form',
            'target': 'new',
            'context': {
                'default_filename': 'PR_Request_Template.xlsx',
                'active_id': records.id,
                'active_model': 'purchase.request',
            }
        }
    else:
        action = {
            'type': 'ir.actions.client',
            'tag': 'display_notification',
            'params': {
                'title': 'Warning',
                'message': 'You can only import data in draft state.',
                'sticky': False,
                'type': 'warning',
            }
        }
</field>
    </record>
</odoo>